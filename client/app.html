<!DOCTYPE html>
<html>
<head>
    <title>Bengaluru House Price Prediction</title>
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300&display=swap" rel="stylesheet">
    <script src=app.js></script>
	    <link rel="stylesheet" href="app.css">
</head>
<body>
<div class="img"></div>
<h1 class="title">Bengaluru House Price Prediction</h1>
<form class="form">
    	<h2 class="sqft">Area in Square Feet</h2>
    <input class="area"  type="number" id="uiSqft" class="floatLabel" name="Squareft" value="100">
    	<h2 class="bhk">BHK</h2>
    	<div class="switch-field"><div class="centre">
		        <input type="radio" id="radio-bhk-1" name="uiBHK" value="1"/>
	            <label for="radio-bhk-1">1</label>
	        	<input type="radio" id="radio-bhk-2" name="uiBHK" value="2"/>
            	<label for="radio-bhk-2">2</label>
        	 	<input type="radio" id="radio-bhk-3" name="uiBHK" value="3"/>
         		<label for="radio-bhk-3">3</label>
	        	<input type="radio" id="radio-bhk-4" name="uiBHK" value="4"/>
           		<label for="radio-bhk-4">4</label>
            	<input type="radio" id="radio-bhk-5" name="uiBHK" value="5"/>
    	    	<label for="radio-bhk-5">5</label>
		</div></div>     
	    </form>
<form class="form">
	    <h2 class="bath">Bathroom</h2>
	    <div class="switch-field"><div class="centre">
		        <input type="radio" id="radio-bath-1" name="uiBathrooms" value="1" />
        	    <label for="radio-bath-1">1</label>
		        <input type="radio" id="radio-bath-2" name="uiBathrooms" value="2"/>
	        	<label for="radio-bath-2">2</label>
		        <input type="radio" id="radio-bath-3" name="uiBathrooms" value="3"/>
	        	<label for="radio-bath-3">3</label>
	        	<input type="radio" id="radio-bath-4" name="uiBathrooms" value="4"/>
	        	<label for="radio-bath-4">4</label>
		        <input type="radio" id="radio-bath-5" name="uiBathrooms" value="5"/>
	        	<label for="radio-bath-5">5</label></div>
	    </div></div>
	        	<h2 class="loc">Location</h2>
	    <div>
  <select class="location" name="" id="uiLocations">
     <option value="" disabled="disabled" selected="selected">Select Location</option>
		        <option>Location Name</option>
                <option>Rajaji Nagar</option>
  </select>
</div>
    	<button class="submit" onclick="onClickedEstimatePrice()" type="button">ESTIMATE</button>
        <div id="uiEstimatedPrice" class="result">
				<h2></h2> </div>		

	
	from flask import Flask, request, jsonify
import util
import pickle

app = Flask(__name__)



@app.route('/get_location_names', methods=['GET'])
def get_location_names():
    response = jsonify({
        'locations': util.get_location_names()
    })
    response.headers.add('access-control-allow-origin', '*')

    return response


@app.route('/predict_home_price', methods=['GET', 'POST'])
def predict_home_price():

    total_sqft = float(request.form['total_sqft'])
    location = request.form['location']
    bhk = int(request.form['bhk'])
    bath = int(request.form['bath'])

    response = jsonify({
        'estimated_price': util.get__estimated_price(location, total_sqft, bhk, bath)
    })

    response.headers.add('access-control-allow-origin', '*')
    return response

if __name__ == "__main__":
    print("starting flask server")
    util.load_saved_artifacts()
    app.run()

 

import json
import pickle
import numpy as np

__locations = None
__data_columns = None
#__model = None

def get__estimated_price(locations,sqft, bhk, bath):
    try:
       loc_index = __data_columns.index(location.lower())
    except:
        loc_index = -1

    x = np.zeros(len(__data_columns))
    x[0] = sqft
    x[1] = bhk
    x[2]= bath
    if loc_index >= 0:
        x[loc_index] = 1

    return round(__model.predict([x])[0], 2)

def get_location_names():
    return __locations

def load_saved_artifacts():
    print("load artifacts")
    global  __data_columns
    global  __locations

    global __model
    with open("./artifacts/bengaluru_house_prices_models.pickle", 'rb') as f:
        __model = pickle.load(f)
        print("load artifacts")

    with open("./artifacts/columns.json", 'r') as f:
        __data_columns = json.load(f)['data_columns']
        __locations = __data_columns[3:]

def get_data_columns():
    return __data_columns

if __name__ == '__main__':
    load_saved_artifacts()
    print(get_location_names())
    print(get__estimated_price('1st phase jp nagar', 1000, 2, 2))
    print(get__estimated_price('1st phase jp nagar', 1000, 3, 2))
    print(get__estimated_price('kalhalli', 500, 2, 2))
	</body>
</html>
